{"version":3,"sources":["core/network/index.tsx","core/network/interceptors/reques.tsx","core/network/interceptors/response.tsx","asset/sass/views/mall-register.module.scss","views/mall-register/index.tsx"],"names":["instance","axios","create","baseURL","window","location","origin","apiPost","CancelToken","url","params","arguments","length","undefined","post","Object","objectSpread","interceptors","request","use","config","toast_default","a","loading","error","Promise","reject","response","_ref","data","hide","res","bodyJson","message","concat","JSON","stringify","errorMessage","get_default","includes","status","fail","href","setTimeout","module","exports","container","login-content","loginContent","other-login","otherLogin","login-header","loginHeader","header__tip","headerTip","header__line","headerLine","login__application","loginApplication","application","application__tip","applicationTip","qqLoginBtn","Register","state","account","accountError","password","passwordError","onRegister","_this$state","_this","isVaildAccount","accountVaild","isVaildPassword","passwordVaild","setState","phone","then","antd_mobile_lib_toast__WEBPACK_IMPORTED_MODULE_7___default","info","props","history","push","value","test","onAccountChange","isVaild","onAccountErrorClick","onPassWordChange","onPassWordErrorClick","_this$state2","this","react__WEBPACK_IMPORTED_MODULE_13___default","createElement","className","Style","antd_mobile_lib_input_item__WEBPACK_IMPORTED_MODULE_5___default","onChange","clear","placeholder","onErrorClick","type","maxLength","antd_mobile_lib_wing_blank__WEBPACK_IMPORTED_MODULE_1___default","size","antd_mobile_lib_button__WEBPACK_IMPORTED_MODULE_3___default","onClick","React","Component","withRouter"],"mappings":"kMAOA,IAAMA,EAAWC,IAAMC,OAAO,CAC5BC,QAASC,OAAOC,SAASC,SAyBdC,GAtBON,IAAMO,YAsBH,SAACC,GAA6B,IAAhBC,EAAgBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,GAK5C,OAAOX,EAASc,KAAKL,EAAdM,OAAAC,EAAA,EAAAD,CAAA,GACFL,MAsBPV,EAASiB,aAAaC,QAAQC,IC3DP,SAACC,GAEtB,OADAC,EAAAC,EAAMC,QAAQ,aAAc,EAAG,cAAU,GAClCH,GAGmB,SAACI,GAC3B,OAAOC,QAAQC,OAAOF,KDsDxBxB,EAASiB,aAAaU,SAASR,IE1DP,SAAAS,GAA6B,IAA1BC,EAA0BD,EAA1BC,KAEzB,OADAR,EAAAC,EAAMQ,OACCD,GAGoB,SAACL,GAC5B,GAAIA,EAAMG,SAAU,CAClB,IAAII,EAAMP,EAAMG,SACVK,EAAWD,EAAIF,KAEjBI,EAAO,UAAAC,OAAaC,KAAKC,UAAUJ,IAEjCK,EAAeC,IAAIP,EAAK,yBAM9B,GALIM,IACFJ,EAAO,GAAAC,OAAMG,IAIX,CAAC,KAAKE,SAASR,EAAIS,QAOrB,OALAnB,EAAAC,EAAMmB,KAAK,sBACXrC,OAAOC,SAASqC,KAAO,kBACvBC,WAAW,WACTtB,EAAAC,EAAMQ,QACL,KAIc,MAAfC,EAAIS,SACNP,EAAU,mDAEO,MAAfF,EAAIS,SACNP,EAAU,mDAEO,MAAfF,EAAIS,SACNP,EAAU,mDAEO,MAAfF,EAAIS,SACNP,EAAU,uCAGZZ,EAAAC,EAAMmB,KAAN,oCAAAP,OAA2BD,SAE3BZ,EAAAC,EAAMmB,KAAK,4BAOb,MAJAE,WAAW,WACTtB,EAAAC,EAAMQ,QACL,KAEGN,yBCrDRoB,EAAAC,QAAA,CAAkBC,UAAA,iCAAAC,gBAAA,qCAAAC,aAAA,qCAAAC,cAAA,mCAAAC,WAAA,mCAAAC,eAAA,oCAAAC,YAAA,oCAAAC,YAAA,mCAAAC,UAAA,mCAAAC,aAAA,oCAAAC,WAAA,oCAAAC,mBAAA,0CAAAC,iBAAA,0CAAAC,YAAA,mCAAAC,iBAAA,wCAAAC,eAAA,wCAAAC,WAAA,mRCeZC,6MACJC,MAAQ,CACNC,QAAS,GACTC,cAAc,EACdC,SAAU,GACVC,eAAe,KAEjBC,WAAa,WAAM,IAAAC,EACWC,EAAKP,MAA3BC,EADWK,EACXL,QAASE,EADEG,EACFH,SACXK,EAAiBD,EAAKE,aAAaR,GACnCS,EAAkBH,EAAKI,cAAcR,GACzC,IAAKK,IAAmBE,EAStB,OARKF,GACHD,EAAKK,SAAS,CACZV,cAAc,SAEbQ,GACHH,EAAKK,SAAS,CACZR,eAAe,KAIrB7D,YAAQ,gBAAiB,CACvBsE,MAAOZ,EACPE,aACCW,KAAK,SAAC/C,GACP,GAAIA,EAAK,KACDE,EAAoBF,EAApBE,QAASO,EAAWT,EAAXS,OACfuC,EAAAzD,EAAM0D,KAAK/C,GACI,IAAXO,GACF+B,EAAKU,MAAMC,QAAQC,KAAK,gBAMhCV,aAAe,SAACW,GAEd,MADqB,oBACPC,KAAKD,MAErBE,gBAAkB,SAACF,GACjB,IAAIG,EAAUhB,EAAKE,aAAaW,GAChCb,EAAKK,SAAS,CACZV,cAAeqB,IAGjBhB,EAAKK,SAAS,CACZX,QAASmB,OAGbI,oBAAsB,WACpBT,EAAAzD,EAAM0D,KAAK,uDAEbL,cAAgB,SAACS,GAEf,MADqB,YACPC,KAAKD,MAErBK,iBAAmB,SAACL,GAClB,IAAIG,EAAUhB,EAAKI,cAAcS,GACjCb,EAAKK,SAAS,CACZR,eAAgBmB,IAElBhB,EAAKK,SAAS,CACZT,SAAUiB,OAGdM,qBAAuB,WACrBX,EAAAzD,EAAM0D,KAAK,0HAEJ,IAAAW,EAC+BC,KAAK5B,MAArCE,EADCyB,EACDzB,aAAcE,EADbuB,EACavB,cACpB,OACEyB,EAAAvE,EAAAwE,cAAA,OAAKC,UAAWC,IAAMlD,WACpB+C,EAAAvE,EAAAwE,cAAA,YACED,EAAAvE,EAAAwE,cAAA,OAAKC,UAAWC,IAAK,cACnBH,EAAAvE,EAAAwE,cAAAG,EAAA3E,EAAA,CACEE,MAAO0C,EACPgC,SAAUN,KAAKN,gBACfa,OAAK,EACLC,YAAY,kCACZC,aAAcT,KAAKJ,qBAEnBK,EAAAvE,EAAAwE,cAAA,QAAMC,UAAU,QAAhB,iBAEFF,EAAAvE,EAAAwE,cAAAG,EAAA3E,EAAA,CACEE,MAAO4C,EACP8B,SAAUN,KAAKH,iBACfW,YAAY,2CACZE,KAAK,WACLC,UAAW,GACXJ,OAAK,EACLE,aAAcT,KAAKF,sBAEnBG,EAAAvE,EAAAwE,cAAA,QAAMC,UAAU,QAAhB,iBAEFF,EAAAvE,EAAAwE,cAAAU,EAAAlF,EAAA,CAAWmF,KAAK,MACdZ,EAAAvE,EAAAwE,cAAAY,EAAApF,EAAA,CACEqF,QAASf,KAAKvB,WACdiC,KAAK,UACLG,KAAK,QACLV,UAAU,QAJZ,2BAhGSa,IAAMC,WAgHdC,sBAAW/C","file":"static/js/Register.b344864d.chunk.js","sourcesContent":["import axios from \"axios\";\nimport { request, requestError } from \"@/core/network/interceptors/reques.tsx\";\nimport {\n  response,\n  responseError\n} from \"@/core/network/interceptors/response.tsx\";\n\nconst instance = axios.create({\n  baseURL: window.location.origin\n});\n\nconst CancelToken = axios.CancelToken;\n//暂时没想好要不要用cancelTotal\nexport const cancelTotal: object[] = [];\n\ninterface ICancelData {\n  url: string;\n  cancel?: any;\n}\n\nexport const apiGet = (url: string, params = {}) => {\n  let cancelData: ICancelData = {\n    url: \"\"\n  };\n  cancelData.url = url;\n  return instance.get(url, {\n    params,\n    cancelToken: new CancelToken(c => {\n      cancelData.cancel = c;\n      cancelTotal.push(cancelData);\n    })\n  });\n};\nexport const apiPost = (url: string, params = {}) => {\n  let cancelData: ICancelData = {\n    url: \"\"\n  };\n  cancelData.url = url;\n  return instance.post(url, {\n    ...params\n  });\n};\nexport const apiPut = (url: string, params = {}) => {\n  let cancelData: ICancelData = {\n    url: \"\"\n  };\n  cancelData.url = url;\n  return instance.put(url, {\n    ...params\n  });\n};\nexport const apiDelete = (url: string, params = {}) => {\n  let cancelData: ICancelData = {\n    url: \"\"\n  };\n  cancelData.url = url;\n  return instance.delete(url, {\n    ...params\n  });\n};\n\ninstance.interceptors.request.use(request, requestError);\ninstance.interceptors.response.use(response, responseError);\n\nexport default instance;\n","import { AxiosRequestConfig, AxiosError } from \"axios\";\nimport { Toast } from \"antd-mobile\";\nexport const request = (config: AxiosRequestConfig) => {\n  Toast.loading(\"loading...\", 0, () => {}, true);\n  return config;\n};\n\nexport const requestError = (error: AxiosError) => {\n  return Promise.reject(error);\n};\n","import { AxiosResponse, AxiosError } from \"axios\";\n// base ui comp\nimport { Toast } from \"antd-mobile\";\nimport { get } from \"lodash\";\nexport const response = ({ data }: AxiosResponse) => {\n  Toast.hide();\n  return data;\n};\n\nexport const responseError = (error: AxiosError) => {\n  if (error.response) {\n    let res = error.response;\n    const bodyJson = res.data;\n    // err 不是字符串\n    let message = `error: ${JSON.stringify(bodyJson)}`;\n\n    const errorMessage = get(res, \"bodyJson.errorMessage\");\n    if (errorMessage) {\n      message = `${errorMessage}`;\n    }\n\n    // 401\n    if ([401].includes(res.status)) {\n      // 跳转登录页面;\n      Toast.fail(\"无权限\");\n      window.location.href = \"/spa/login\";\n      setTimeout(() => {\n        Toast.hide();\n      }, 2000);\n      return;\n    }\n    // 404\n    if (res.status === 404) {\n      message = \"服务暂不可用. eror: 404\";\n    }\n    if (res.status === 500) {\n      message = \"服务暂不可用. eror: 500\";\n    }\n    if (res.status === 502) {\n      message = \"服务暂不可用. eror: 502\";\n    }\n    if (res.status === 504) {\n      message = \"请求超时. eror: 504\";\n    }\n\n    Toast.fail(`请求错误. error: ${message}`);\n  } else {\n    Toast.fail(\"请求错误\");\n  }\n\n  setTimeout(() => {\n    Toast.hide();\n  }, 2000);\n\n  throw error;\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"mall-register_container__3As3D\",\"login-content\":\"mall-register_login-content__2v4he\",\"loginContent\":\"mall-register_login-content__2v4he\",\"other-login\":\"mall-register_other-login__2KW6o\",\"otherLogin\":\"mall-register_other-login__2KW6o\",\"login-header\":\"mall-register_login-header__ueHyb\",\"loginHeader\":\"mall-register_login-header__ueHyb\",\"header__tip\":\"mall-register_header__tip__2z8Zz\",\"headerTip\":\"mall-register_header__tip__2z8Zz\",\"header__line\":\"mall-register_header__line__2-IEV\",\"headerLine\":\"mall-register_header__line__2-IEV\",\"login__application\":\"mall-register_login__application__28XdP\",\"loginApplication\":\"mall-register_login__application__28XdP\",\"application\":\"mall-register_application__3F_qx\",\"application__tip\":\"mall-register_application__tip__2Oxa2\",\"applicationTip\":\"mall-register_application__tip__2Oxa2\",\"qqLoginBtn\":\"mall-register_qqLoginBtn__PfEnv\"};","import React from \"react\";\n// base ui comp\nimport { InputItem, Button, WingBlank, Toast } from \"antd-mobile\";\nimport { withRouter } from \"react-router\";\n// scss\nimport Style from \"@/asset/sass/views/mall-register.module.scss\";\n// network\nimport { apiPost } from \"@/core/network\";\n\ninterface ContainerState {\n  account: string;\n  accountError: boolean;\n  password: string;\n  passwordError: boolean;\n}\n\nclass Register extends React.Component<any, ContainerState> {\n  state = {\n    account: \"\",\n    accountError: false,\n    password: \"\",\n    passwordError: false\n  };\n  onRegister = () => {\n    let { account, password } = this.state;\n    let isVaildAccount = this.accountVaild(account);\n    let isVaildPassword = this.passwordVaild(password);\n    if (!isVaildAccount || !isVaildPassword) {\n      if (!isVaildAccount)\n        this.setState({\n          accountError: true\n        });\n      if (!isVaildPassword)\n        this.setState({\n          passwordError: true\n        });\n      return;\n    }\n    apiPost(\"/api/register\", {\n      phone: account,\n      password\n    }).then((res: any) => {\n      if (res) {\n        let { message, status } = res;\n        Toast.info(message);\n        if (status === 2) {\n          this.props.history.push(\"/login\");\n        }\n      }\n    });\n  };\n\n  accountVaild = (value: string): boolean => {\n    let regExp: RegExp = /^1[3456789]\\d{9}$/;\n    return regExp.test(value);\n  };\n  onAccountChange = (value: string): void => {\n    let isVaild = this.accountVaild(value);\n    this.setState({\n      accountError: !isVaild\n    });\n\n    this.setState({\n      account: value\n    });\n  };\n  onAccountErrorClick = () => {\n    Toast.info(\"请输入规范手机号\");\n  };\n  passwordVaild = (value: string): boolean => {\n    let regExp: RegExp = /\\d{6,12}$/;\n    return regExp.test(value);\n  };\n  onPassWordChange = (value: string): void => {\n    let isVaild = this.passwordVaild(value);\n    this.setState({\n      passwordError: !isVaild\n    });\n    this.setState({\n      password: value\n    });\n  };\n  onPassWordErrorClick = () => {\n    Toast.info(\"请输入6到12位密码\");\n  };\n  render() {\n    let { accountError, passwordError } = this.state;\n    return (\n      <div className={Style.container}>\n        <form>\n          <div className={Style[\"loginContent\"]}>\n            <InputItem\n              error={accountError}\n              onChange={this.onAccountChange}\n              clear\n              placeholder=\"手机号/邮箱\"\n              onErrorClick={this.onAccountErrorClick}\n            >\n              <span className=\"fz20\">账号</span>\n            </InputItem>\n            <InputItem\n              error={passwordError}\n              onChange={this.onPassWordChange}\n              placeholder=\"请输入6-20位密码\"\n              type=\"password\"\n              maxLength={20}\n              clear\n              onErrorClick={this.onPassWordErrorClick}\n            >\n              <span className=\"fz20\">密码</span>\n            </InputItem>\n            <WingBlank size=\"lg\">\n              <Button\n                onClick={this.onRegister}\n                type=\"primary\"\n                size=\"large\"\n                className=\"mt30\"\n              >\n                注册\n              </Button>\n            </WingBlank>\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Register);\n"],"sourceRoot":""}